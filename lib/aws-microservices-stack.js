"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AwsMicroservicesStack = void 0;
const cdk = require("aws-cdk-lib");
const database_1 = require("./database");
const microservices_1 = require("./microservices");
const apigateway_1 = require("./apigateway");
const eventbus_1 = require("./eventbus");
class AwsMicroservicesStack extends cdk.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const database = new database_1.SwnDatabase(this, 'Database');
        const microservices = new microservices_1.SwnMicroservices(this, "Microservices", {
            productTable: database.productTable,
            basketTable: database.basketTable,
            orderTable: database.orderTable
        });
        const apigateway = new apigateway_1.SwnApiGateway(this, "ApiGateway", {
            productMicroservice: microservices.productMicroservice,
            basketMicroservice: microservices.basketMicroservice,
            orderingMicroservice: microservices.orderingMicroservice
        });
        const eventBus = new eventbus_1.SwnEventBus(this, 'EventBus', {
            publisherFunction: microservices.basketMicroservice,
            targetFuntion: microservices.orderingMicroservice
        });
    }
}
exports.AwsMicroservicesStack = AwsMicroservicesStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXdzLW1pY3Jvc2VydmljZXMtc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhd3MtbWljcm9zZXJ2aWNlcy1zdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxtQ0FBbUM7QUFFbkMseUNBQXlDO0FBQ3pDLG1EQUFtRDtBQUNuRCw2Q0FBNkM7QUFDN0MseUNBQXlDO0FBSXpDLE1BQWEscUJBQXNCLFNBQVEsR0FBRyxDQUFDLEtBQUs7SUFDbEQsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFzQjtRQUM5RCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixNQUFNLFFBQVEsR0FBRyxJQUFJLHNCQUFXLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBRW5ELE1BQU0sYUFBYSxHQUFHLElBQUksZ0NBQWdCLENBQUMsSUFBSSxFQUFFLGVBQWUsRUFBRTtZQUNoRSxZQUFZLEVBQUUsUUFBUSxDQUFDLFlBQVk7WUFDbkMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxXQUFXO1lBQ2pDLFVBQVUsRUFBRSxRQUFRLENBQUMsVUFBVTtTQUNoQyxDQUFDLENBQUM7UUFFSCxNQUFNLFVBQVUsR0FBRyxJQUFJLDBCQUFhLENBQUMsSUFBSSxFQUFFLFlBQVksRUFBRTtZQUN2RCxtQkFBbUIsRUFBRSxhQUFhLENBQUMsbUJBQW1CO1lBQ3RELGtCQUFrQixFQUFFLGFBQWEsQ0FBQyxrQkFBa0I7WUFDcEQsb0JBQW9CLEVBQUUsYUFBYSxDQUFDLG9CQUFvQjtTQUN6RCxDQUFDLENBQUM7UUFFSCxNQUFNLFFBQVEsR0FBRyxJQUFJLHNCQUFXLENBQUMsSUFBSSxFQUFFLFVBQVUsRUFBRTtZQUNqRCxpQkFBaUIsRUFBRSxhQUFhLENBQUMsa0JBQWtCO1lBQ25ELGFBQWEsRUFBRSxhQUFhLENBQUMsb0JBQW9CO1NBQ2xELENBQUMsQ0FBQTtJQUVKLENBQUM7Q0FDRjtBQXhCRCxzREF3QkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjZGsgZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBTd25EYXRhYmFzZSB9IGZyb20gJy4vZGF0YWJhc2UnO1xuaW1wb3J0IHsgU3duTWljcm9zZXJ2aWNlcyB9IGZyb20gJy4vbWljcm9zZXJ2aWNlcyc7XG5pbXBvcnQgeyBTd25BcGlHYXRld2F5IH0gZnJvbSAnLi9hcGlnYXRld2F5JztcbmltcG9ydCB7IFN3bkV2ZW50QnVzIH0gZnJvbSAnLi9ldmVudGJ1cyc7XG5cblxuXG5leHBvcnQgY2xhc3MgQXdzTWljcm9zZXJ2aWNlc1N0YWNrIGV4dGVuZHMgY2RrLlN0YWNrIHtcbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM/OiBjZGsuU3RhY2tQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xuXG4gICAgY29uc3QgZGF0YWJhc2UgPSBuZXcgU3duRGF0YWJhc2UodGhpcywgJ0RhdGFiYXNlJyk7XG5cbiAgICBjb25zdCBtaWNyb3NlcnZpY2VzID0gbmV3IFN3bk1pY3Jvc2VydmljZXModGhpcywgXCJNaWNyb3NlcnZpY2VzXCIsIHtcbiAgICAgIHByb2R1Y3RUYWJsZTogZGF0YWJhc2UucHJvZHVjdFRhYmxlLFxuICAgICAgYmFza2V0VGFibGU6IGRhdGFiYXNlLmJhc2tldFRhYmxlLFxuICAgICAgb3JkZXJUYWJsZTogZGF0YWJhc2Uub3JkZXJUYWJsZVxuICAgIH0pO1xuXG4gICAgY29uc3QgYXBpZ2F0ZXdheSA9IG5ldyBTd25BcGlHYXRld2F5KHRoaXMsIFwiQXBpR2F0ZXdheVwiLCB7XG4gICAgICBwcm9kdWN0TWljcm9zZXJ2aWNlOiBtaWNyb3NlcnZpY2VzLnByb2R1Y3RNaWNyb3NlcnZpY2UsXG4gICAgICBiYXNrZXRNaWNyb3NlcnZpY2U6IG1pY3Jvc2VydmljZXMuYmFza2V0TWljcm9zZXJ2aWNlLFxuICAgICAgb3JkZXJpbmdNaWNyb3NlcnZpY2U6IG1pY3Jvc2VydmljZXMub3JkZXJpbmdNaWNyb3NlcnZpY2VcbiAgICB9KTtcblxuICAgIGNvbnN0IGV2ZW50QnVzID0gbmV3IFN3bkV2ZW50QnVzKHRoaXMsICdFdmVudEJ1cycsIHtcbiAgICAgIHB1Ymxpc2hlckZ1bmN0aW9uOiBtaWNyb3NlcnZpY2VzLmJhc2tldE1pY3Jvc2VydmljZSxcbiAgICAgIHRhcmdldEZ1bnRpb246IG1pY3Jvc2VydmljZXMub3JkZXJpbmdNaWNyb3NlcnZpY2VcbiAgICB9KVxuICAgIFxuICB9XG59XG4iXX0=